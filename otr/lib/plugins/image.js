var dsRTE_insertImage=function(){this.ExecuteCommand=function(a,b,c){c.slideToggle();return true};this.PrepareCommand=function(b,c,d,f){var g=c;$('#'+c+'-ok').click(function(){b.frame.focus();$.ajaxFileUpload({url:f.attr('path'),secureuri:false,fileElementId:g,dataType:'json',success:function(a,s){if(a.error){alert(a.error)}else{b.frame.focus();$('#'+c).val('');d.slideUp();b.doc.execCommand('insertimage',false,a.path+'/'+encodeURIComponent(a.file))}},error:function(a,s,e){alert(e+': '+a.responseText)}})});return true}};dsRTE.RegisterPlugin(new dsRTE_insertImage(),'image');
